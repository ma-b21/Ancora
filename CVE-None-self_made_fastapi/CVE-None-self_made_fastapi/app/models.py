from sqlalchemy import Boolean, Column, String

from app.database import Base
import uuid
import random
import string
import hashlib

def generate_salt(length=8):  
    """生成随机盐值"""  
    return ''.join(random.choice(string.ascii_letters + string.digits) for _ in range(length))  

def generate_salted_uuid():  
    """生成带盐的唯一 UUID"""  
    salt = generate_salt()  # 生成盐  
    new_uuid = str(uuid.uuid4())  # 生成 UUID  
    # 结合盐和 UUID，并对其进行哈希处理  
    salted_uuid = hashlib.sha256((salt + new_uuid).encode()).hexdigest()  
    return salted_uuid  

class User(Base):
    __tablename__ = "users"

    id = Column(String, primary_key=True, default=generate_salted_uuid)
    email = Column(String, unique=True, index=True)
    hashed_password = Column(String)
    is_active = Column(Boolean, default=True)
